---
import Layout from '../../layouts/Layout.astro';
import Card from '../../components/Card.astro';

// Import all teaching markdown files (from root and subdirectories)
const teachingRootFiles = await Astro.glob('../../../docs/teaching/*.md');
const teachingCourseFiles = await Astro.glob('../../../docs/teaching/courses/*.md');
const teachingExperienceFiles = await Astro.glob('../../../docs/teaching/experience/*.md');

// Group the files by type
const teachingPhilosophy = teachingRootFiles.find(file => file.file.includes('teaching-philosophy.md'));
const coursesInfo = teachingRootFiles.find(file => file.file.includes('courses-taught.md'));
const experienceInfo = teachingRootFiles.find(file => file.file.includes('experience.md'));
const resourcesInfo = teachingRootFiles.find(file => file.file.includes('resources.md'));

// Transform the course data for cards
const courses = teachingCourseFiles.map(file => ({
  title: file.frontmatter.title || file.file.split('/').pop().replace('.md', ''),
  description: file.frontmatter.description || '',
  categories: file.frontmatter.categories || [],
  content: file.Content,
}));

// Transform the experience data for cards
const experiences = teachingExperienceFiles.map(file => ({
  title: file.frontmatter.title || file.file.split('/').pop().replace('.md', ''),
  description: file.frontmatter.description || '',
  categories: file.frontmatter.categories || [],
  content: file.Content,
}));
---

<Layout title="Teaching | Michael Borck">
  <div class="magazine-section">
    <h1 class="section-title">Teaching</h1>
    
    {teachingPhilosophy && (
      <section class="teaching-philosophy">
        <h2>Teaching Philosophy</h2>
        <div class="philosophy-content">
          <teachingPhilosophy.Content />
        </div>
      </section>
    )}
    
    <section class="teaching-courses">
      <h2>Courses</h2>
      {coursesInfo && (
        <div class="courses-intro">
          <coursesInfo.Content />
        </div>
      )}
      
      <div class="card-grid">
        {courses.map((course) => (
          <Card 
            title={course.title}
            description={course.description}
            categories={course.categories}
          >
            <div class="course-content">
              <course.content />
            </div>
          </Card>
        ))}
      </div>
    </section>
    
    <section class="teaching-experience">
      <h2>Teaching Experience</h2>
      {experienceInfo && (
        <div class="experience-intro">
          <experienceInfo.Content />
        </div>
      )}
      
      <div class="experience-timeline">
        {experiences.map((experience) => (
          <div class="timeline-item">
            <h3>{experience.title}</h3>
            <p class="timeline-description">{experience.description}</p>
            <div class="timeline-content">
              <experience.content />
            </div>
          </div>
        ))}
      </div>
    </section>
    
    {resourcesInfo && (
      <section class="teaching-resources">
        <h2>Resources</h2>
        <div class="resources-content">
          <resourcesInfo.Content />
        </div>
      </section>
    )}
  </div>
</Layout>

<style>
  section {
    margin-bottom: 3rem;
  }
  
  h2 {
    font-size: 1.8rem;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #eaeaea;
  }
  
  .philosophy-content,
  .courses-intro,
  .experience-intro,
  .resources-content {
    max-width: 800px;
    margin-bottom: 2rem;
  }
  
  .experience-timeline {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }
  
  .timeline-item {
    position: relative;
    padding-left: 2rem;
    border-left: 3px solid var(--accent-light);
    padding-bottom: 2rem;
  }
  
  .timeline-item h3 {
    color: var(--accent-light);
  }
  
  .timeline-description {
    font-style: italic;
    margin-bottom: 1rem;
  }
  
  .course-content,
  .timeline-content {
    margin-top: 1rem;
  }
</style>